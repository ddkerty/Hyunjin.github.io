<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장비 강화 시뮬레이터</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="simulator-container">
        <h1>장비 강화 시뮬레이터</h1>
        
        <div class="simulator-controls">
            <div class="control-group">
                <label for="startLevel">시작 강화 단계:</label>
                <input type="number" id="startLevel" min="0" max="20" value="0">
            </div>
            <div class="control-group">
                <label for="targetLevel">목표 강화 단계:</label>
                <input type="number" id="targetLevel" min="0" max="20" value="10">
            </div>
            <div class="control-group">
                <label for="successRate">성공 확률 (%):</label>
                <input type="number" id="successRate" min="0" max="100" value="50">
            </div>
            <div class="control-group">
                <label for="simulationCount">시뮬레이션 횟수:</label>
                <input type="number" id="simulationCount" min="1" max="10000" value="1000">
            </div>
            <button id="startSimulation" class="btn">시뮬레이션 시작</button>
        </div>

        <div class="simulator-results">
            <div class="result-card">
                <h3>평균 시도 횟수</h3>
                <p id="averageAttempts">-</p>
            </div>
            <div class="result-card">
                <h3>최소 시도 횟수</h3>
                <p id="minAttempts">-</p>
            </div>
            <div class="result-card">
                <h3>최대 시도 횟수</h3>
                <p id="maxAttempts">-</p>
            </div>
            <div class="result-card">
                <h3>성공 확률</h3>
                <p id="successProbability">-</p>
            </div>
        </div>

        <div class="simulator-chart">
            <canvas id="attemptsChart"></canvas>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startSimulationBtn = document.getElementById('startSimulation');
            const startLevelInput = document.getElementById('startLevel');
            const targetLevelInput = document.getElementById('targetLevel');
            const successRateInput = document.getElementById('successRate');
            const simulationCountInput = document.getElementById('simulationCount');
            
            const averageAttemptsElement = document.getElementById('averageAttempts');
            const minAttemptsElement = document.getElementById('minAttempts');
            const maxAttemptsElement = document.getElementById('maxAttempts');
            const successProbabilityElement = document.getElementById('successProbability');
            
            let attemptsChart = null;

            startSimulationBtn.addEventListener('click', () => {
                const startLevel = parseInt(startLevelInput.value);
                const targetLevel = parseInt(targetLevelInput.value);
                const successRate = parseInt(successRateInput.value) / 100;
                const simulationCount = parseInt(simulationCountInput.value);

                if (startLevel >= targetLevel) {
                    alert('시작 강화 단계는 목표 강화 단계보다 낮아야 합니다.');
                    return;
                }

                const results = runSimulation(startLevel, targetLevel, successRate, simulationCount);
                updateResults(results);
                updateChart(results.attempts);
            });

            function runSimulation(startLevel, targetLevel, successRate, count) {
                const attempts = [];
                let successCount = 0;

                for (let i = 0; i < count; i++) {
                    let currentLevel = startLevel;
                    let attemptCount = 0;

                    while (currentLevel < targetLevel) {
                        attemptCount++;
                        if (Math.random() < successRate) {
                            currentLevel++;
                        } else {
                            currentLevel = Math.max(0, currentLevel - 1);
                        }
                    }

                    attempts.push(attemptCount);
                    if (currentLevel === targetLevel) {
                        successCount++;
                    }
                }

                return {
                    attempts,
                    successCount,
                    successRate: successCount / count
                };
            }

            function updateResults(results) {
                const attempts = results.attempts;
                const average = attempts.reduce((a, b) => a + b, 0) / attempts.length;
                const min = Math.min(...attempts);
                const max = Math.max(...attempts);

                averageAttemptsElement.textContent = average.toFixed(2);
                minAttemptsElement.textContent = min;
                maxAttemptsElement.textContent = max;
                successProbabilityElement.textContent = `${(results.successRate * 100).toFixed(2)}%`;
            }

            function updateChart(attempts) {
                const ctx = document.getElementById('attemptsChart').getContext('2d');
                
                if (attemptsChart) {
                    attemptsChart.destroy();
                }

                const labels = Array.from({length: Math.max(...attempts) + 1}, (_, i) => i);
                const data = new Array(labels.length).fill(0);
                attempts.forEach(attempt => data[attempt]++);

                attemptsChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '시도 횟수 분포',
                            data: data,
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                            borderColor: 'rgba(52, 152, 219, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '빈도'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: '시도 횟수'
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html> 